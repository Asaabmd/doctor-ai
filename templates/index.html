<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Doctor AI</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    function startDictation(id) {
      if (window.hasOwnProperty('webkitSpeechRecognition')) {
        var recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US';
        recognition.start();

        recognition.onresult = function(e) {
          document.getElementById(id).value = e.results[0][0].transcript;
          recognition.stop();
        };
        recognition.onerror = function(e) {
          recognition.stop();
        };
      }
    }

    function autoAdvance(id) {
      const formElements = Array.from(document.querySelectorAll("textarea, input"));
      const index = formElements.findIndex(el => el.id === id);
      if (index >= 0 && index < formElements.length - 1) {
        formElements[index + 1].focus();
        formElements[index + 1].scrollIntoView({ behavior: "smooth", block: "center" });
      }
    }
  </script>
  <style>
    body {
      background-color: white;
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .logo {
      float: right;
      width: 100px;
    }
    .doctor {
      float: left;
      width: 100px;
    }
    textarea, input[type="text"], input[type="email"] {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
    }
    .mic-button {
      background: none;
      border: none;
      font-size: 1.2em;
      cursor: pointer;
    }
    .disclaimer, .instructions {
      background-color: #e0f0ff;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <img src="{{ url_for('static', filename='doctor.jpeg') }}" alt="Doctor" class="doctor">
  <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo">
  <h1>Doctor AI Symptom Checker</h1>

  <div class="instructions">
    <strong>Instructions:</strong><br>
    Please complete all fields in detail to get a customized summary.<br>
    Press <b>Enter</b> or click the <b>ðŸŽ¤</b> icon to speak. Auto-scroll will help you navigate.<br>
  </div>

  <div class="disclaimer">
    <strong>Disclaimer:</strong><br>
    This app provides educational summaries and is not a substitute for professional medical advice.
  </div>

  <form method="POST" action="/summary">
    <input type="email" name="email" id="email" required placeholder="Enter your email address" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('email');}">

    <input type="text" name="age" id="age" required placeholder="Your age" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('age');}">
    <input type="text" name="sex" id="sex" required placeholder="Your sex (e.g., male, female)" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('sex');}">

    <textarea name="symptoms" id="symptoms" required placeholder="Describe your symptoms in detail. The more details you provide, the more specific your summary." onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('symptoms');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('symptoms')">ðŸŽ¤</button>

    <textarea name="conditions" id="conditions" placeholder="What are your current medical conditions?" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('conditions');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('conditions')">ðŸŽ¤</button>

    <textarea name="allergies" id="allergies" placeholder="List any allergies to medications, food, or other items. If none, enter 'None'." onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('allergies');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('allergies')">ðŸŽ¤</button>

    <textarea name="medications" id="medications" placeholder="What medications or supplements are you currently taking?" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('medications');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('medications')">ðŸŽ¤</button>

    <textarea name="onset" id="onset" placeholder="When did your symptoms start?" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('onset');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('onset')">ðŸŽ¤</button>

    <textarea name="better" id="better" placeholder="What makes your symptoms better? If unsure, enter 'NA'." onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('better');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('better')">ðŸŽ¤</button>

    <textarea name="worse" id="worse" placeholder="What makes your symptoms worse? If unsure, enter 'NA'." onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('worse');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('worse')">ðŸŽ¤</button>

    <textarea name="severity" id="severity" placeholder="How severe are your symptoms on a scale of 1 to 10? (10 is the most severe)" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('severity');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('severity')">ðŸŽ¤</button>

    <textarea name="treatments" id="treatments" placeholder="What medications or remedies have you tried so far?" onkeydown="if(event.key==='Enter'){event.preventDefault(); autoAdvance('treatments');}"></textarea>
    <button class="mic-button" type="button" onclick="startDictation('treatments')">ðŸŽ¤</button>

    <br><br>
    <button type="submit">Submit</button>
  </form>
</body>
</html>
