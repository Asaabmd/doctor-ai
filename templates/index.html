<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Doctor AI ‚Äì Symptom Checker (Educational)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --blue: #0b72d9;
      --blue-dark: #065bb0;
      --muted: #475569;
      --bg: #f8fbff;
      --panel: #ffffff;
      --note: #e6f0ff;
    }
    html, body {
      margin: 0; padding: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg); color: #0f172a; line-height: 1.6;
    }
    .wrap { max-width: 900px; margin: auto; padding: 20px; }
    header { display:flex; justify-content:space-between; align-items:center; margin-bottom: 12px; }
    header img.logo { height:60px; }
    header img.doctor { height:60px; border-radius:12px; }
    h1 { text-align:center; color: var(--blue-dark); margin: 8px 0 16px; }

    .info, .reminder, .disclaimer {
      background: var(--note);
      padding: 14px 16px;
      border-radius: 10px;
      border-left: 5px solid var(--blue-dark);
      margin-bottom: 16px;
    }
    .panel {
      background: var(--panel);
      border-radius: 12px;
      box-shadow: 0 4px 14px rgba(0,0,0,.06);
      padding: 18px;
    }

    .row { margin-bottom: 14px; }
    label { font-weight: 700; color: var(--muted); display:block; margin-bottom:6px; }

    input, textarea, select {
      width: 100%;
      font-size: 16px;
      padding: 10px 12px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      background: #fff;
      outline: none;
    }
    textarea { min-height: 90px; resize: vertical; }

    .micline { display:flex; align-items:center; gap:8px; }
    .mic-btn {
      padding: 6px 10px;
      font-weight: 700;
      background: #cce5ff;
      border: 1px solid #93c5fd;
      border-radius: 8px;
      cursor: pointer;
    }

    .submit {
      background: var(--blue);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 12px 18px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      margin-top: 6px;
    }
    .submit:hover { background: var(--blue-dark); }
  </style>

  <script>
    // Enter-to-advance & smooth scroll
    document.addEventListener("DOMContentLoaded", () => {
      const fields = Array.from(document.querySelectorAll("input, textarea, select"));
      fields.forEach((el, idx) => {
        el.addEventListener("keydown", (e) => {
          if (e.key === "Enter" && !e.shiftKey && el.tagName !== "SELECT") {
            e.preventDefault();
            const next = fields[idx + 1];
            if (next) {
              next.focus();
              next.scrollIntoView({ behavior: "smooth", block: "center" });
            }
          }
        });
      });
    });

    // Web Speech API (Chrome/Edge)
    function startDictation(btn, fieldId) {
      const field = document.getElementById(fieldId);
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SR) {
        alert("Speech recognition not supported. Please use Chrome or Edge.");
        return;
      }
      const recog = new SR();
      recog.lang = "en-US";
      recog.interimResults = false;
      recog.maxAlternatives = 1;

      btn.disabled = true;
      recog.onresult = (ev) => {
        const t = ev.results[0][0].transcript.trim();
        field.value += (field.value ? " " : "") + t;
        field.focus();
      };
      recog.onerror = () => alert("Mic error. Try again.");
      recog.onend = () => { btn.disabled = false; };
      recog.start();
    }
  </script>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="/static/doctor.jpeg" class="doctor" alt="Doctor">
      <img src="/static/logo.png" class="logo" alt="Logo">
    </header>

    <h1>Doctor AI</h1>

    <div class="info">
      <p><strong>What this app does:</strong> Doctor AI provides a personalized, <em>educational</em> summary based on your symptoms ‚Äî including possible causes, red flags, and home/OTC options. This tool is not a substitute for professional care.</p>
      <p>You can type or click üé§ to speak. Press <strong>Enter</strong> to jump to the next question. The more detail you provide, the more specific your summary will be.</p>
    </div>

    <form class="panel" method="POST" action="/submit" autocomplete="off">
      <div class="row">
        <label for="email">Your Email (required to check subscription)</label>
        <input type="email" id="email" name="email" required placeholder="name@example.com" />
      </div>

      <div class="row">
        <label for="sex">Sex</label>
        <select id="sex" name="sex" required>
          <option value="">Select your sex</option>
          <option>Male</option><option>Female</option><option>Other</option>
        </select>
      </div>

      <div class="row">
        <label for="age_group">Age Group</label>
        <select id="age_group" name="age_group" required>
          <option value="">Select age group</option>
          <option>0‚Äì12 (Child)</option>
          <option>13‚Äì19 (Teen)</option>
          <option>20‚Äì39 (Young Adult)</option>
          <option>40‚Äì64 (Adult)</option>
          <option>65+ (Senior)</option>
        </select>
      </div>

      <div class="row">
        <label for="symptoms">Describe your symptoms</label>
        <div class="micline">
          <textarea id="symptoms" name="symptoms" required placeholder="Describe your symptoms in detail (onset, location, character, timing, associated symptoms, pattern). The more details you provide, the more customized your summary."></textarea>
          <button class="mic-btn" type="button" onclick="startDictation(this, 'symptoms')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="conditions">Existing conditions</label>
        <div class="micline">
          <textarea id="conditions" name="conditions" placeholder="List your current/chronic medical conditions. If none, enter 'None'."></textarea>
          <button class="mic-btn" type="button" onclick="startDictation(this, 'conditions')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="allergies">Allergies</label>
        <div class="micline">
          <textarea id="allergies" name="allergies" placeholder="Allergies to medications, foods, or other items. If none, enter 'None'."></textarea>
          <button class="mic-btn" type="button" onclick="startDictation(this, 'allergies')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="medications">Current medications</label>
        <div class="micline">
          <textarea id="medications" name="medications" placeholder="List all prescription and over-the-counter medications and supplements."></textarea>
          <button class="mic-btn" type="button" onclick="startDictation(this, 'medications')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="onset">When did it start?</label>
        <div class="micline">
          <input id="onset" name="onset" placeholder="For example: 'Three days ago' or 'This morning'">
          <button class="mic-btn" type="button" onclick="startDictation(this, 'onset')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="better">What makes it better?</label>
        <div class="micline">
          <input id="better" name="better" placeholder="Rest, fluids, certain positions, medications‚Ä¶ If not sure, enter 'Not sure'." />
          <button class="mic-btn" type="button" onclick="startDictation(this, 'better')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="worse">What makes it worse?</label>
        <div class="micline">
          <input id="worse" name="worse" placeholder="Movement, eating, stress, certain times‚Ä¶ If not sure, enter 'Not sure'." />
          <button class="mic-btn" type="button" onclick="startDictation(this, 'worse')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="severity">Severity (1‚Äì10)</label>
        <div class="micline">
          <input id="severity" name="severity" placeholder="Rate your symptoms from 1 (mild) to 10 (most severe). Example: '7/10'." />
          <button class="mic-btn" type="button" onclick="startDictation(this, 'severity')">üé§</button>
        </div>
      </div>

      <div class="row">
        <label for="tried">What have you tried?</label>
        <div class="micline">
          <textarea id="tried" name="tried" placeholder="Medications (with doses), home remedies, rest, ice/heat, hydration, etc."></textarea>
          <button class="mic-btn" type="button" onclick="startDictation(this, 'tried')">üé§</button>
        </div>
      </div>

      <div class="reminder">
        ‚è≥ Please complete all fields and wait a few moments after clicking Submit.
      </div>
      <button class="submit" type="submit">Submit for Summary</button>
    </form>

    <div class="disclaimer" style="margin-top:14px;">
      <strong>Disclaimer:</strong> Doctor AI is for educational purposes only and does not provide medical advice, diagnosis, or treatment. If you think you may have a medical emergency, call your local emergency number.
    </div>
  </div>
</body>
</html>